/*
 Copyright 2011, Cardinal Path and Direct Performance.

 GAS - Google Analytics on Steroids
 https://bitbucket.org/dpc/gas

 @author Eduardo Cereto <eduardocereto@gmail.com>
 $Revision$
 $Date$
 Licensed under the MIT license.
*/
(function(h,m){function o(){this.tracker=h._gat._getTrackers()[0]}function q(){var a=this;a.b={};a.i=0;a.j=u;a.e="_gas1";a.f={};a.d={_addHook:[a.k]};a.push(function(){a.f=new o})}function p(a){if(_gas.m)try{console.log(a)}catch(b){}return h._gaq.push(a)}function C(a,b){if(typeof a!=="string")return!1;var c=a.split("?")[0],c=c.split(".");return(c=c[c.length-1])&&this.g(b,c)?c:!1}function D(a){var b=this;this.a(h,"mousedown",function(c){if(c.target&&c.target.tagName==="A"){var d=C.call(b,c.target.href,
a);d&&_gas.push(["_trackEvent","Download",d,c.target.href])}})}function E(a,b){function c(b){var c=b.target,c=c.name||c.id||c.type||c.nodeName,b=b.type,d=a.name||a.id||m;_gas.push(["_trackEvent","Form Tracking","form"+(d?" ("+d+")":""),c+" ("+b+")"])}var d=this;if(b)d.a(h,"click",function(a){try{var b=a.target;a.type=="click"&&d.g(["button","submit","image","reset"],b.type.toLowerCase())&&c(a)}catch(e){}}),d.a(f.body,"change",function(a){try{var b=a.target;a.type=="change"&&d.g(["input","select",
"textarea","hidden"],b.nodeName.toLowerCase())&&c(a)}catch(e){}});else{var g,e;if(!a.elements||!a.elements.length)return!1;for(g=0;g<a.elements.length;g++)e=a.elements[g],d.g(["button","submit","image","reset"],e.type)?d.a(e,"click",c):d.a(e,"change",c);d.a(a,"submit",c)}}function v(){return Math.max(f.body.scrollHeight||0,l.scrollHeight||0,f.body.offsetHeight||0,l.offsetHeight||0,f.body.clientHeight||0,l.clientHeight||0)}function w(a){t&&clearTimeout(t);a===!0?k=Math.max(((h.pageYOffset||f.body.scrollTop||
l.scrollTop||0)+(h.innerHeight||l.clientHeight||f.body.clientHeight||0))/v()*100,k):t=setTimeout(function(){k=Math.max(((h.pageYOffset||f.body.scrollTop||l.scrollTop||0)+(h.innerHeight||l.clientHeight||f.body.clientHeight||0))/v()*100,k)},400)}function F(){w(!0);k=Math.floor(k);if(!(k<=0||k>100)){var a=(k>10?1:0)*(Math.floor((k-1)/10)*10+1),a=String(a)+"-"+String(Math.ceil(k/10)*10);_gas.push(["_trackEvent","Max Scroll",x,a,Math.floor(k),!0])}}function r(a,b,c){if(c.contentWindow&&c.contentWindow.postMessage){var d=
c.getAttribute("src").split("?")[0],a=JSON.stringify({method:a,value:b});c.contentWindow.postMessage(a,d)}}function y(a){for(var b=f.getElementsByTagName("iframe"),c=0,d,g,e,j=0;j<b.length;j++)if(i.call(b[j].src,"//player.vimeo.com")>-1){d="gas_vimeo_"+j;g=b[j].src;e="?";i.call(g,"?")>-1&&(e="&");if(i.call(g,"api=1")<0)if(a)g+=e+"api=1&player_id="+d;else break;else i.call(g,"player_id=")<-1&&(g+=e+"player_id="+d);c++;b[j].id=d;if(b[j].src!==g){b[j].src=g;break}r("getVideoUrl","",b[j]);r("addEventListener",
"play",b[j]);r("addEventListener","pause",b[j]);r("addEventListener","finish",b[j])}c>0&&z===!1&&(this.a(h,"message",function(a){if(i.call(a.origin,"//player.vimeo.com")>-1)if(a=JSON.parse(a.data),a.event==="ready")y();else if(a.method){if(a.method=="getVideoUrl")A[a.o]=a.value}else _gas.push(["_trackEvent","Vimeo Video",a.event,A[a.o]])},!1),z=!0)}function G(a){var b="";switch(a.data){case 0:b="finish";break;case 1:b="play";break;case 2:b="pause"}b&&_gas.push(["_trackEvent","YouTube Video",b,a.target.getVideoUrl()])}
function H(a){_gas.push(["_trackEvent","YouTube Video","error ("+a.data+")",a.target.getVideoUrl()])}function I(a){for(var b=[],c=f.getElementsByTagName("iframe"),d=0;d<c.length;d++)if(i.call(c[d].src,"//www.youtube.com/embed")>-1){if(i.call(c[d].src,"enablejsapi=1")<0)if(a)c[d].src+=i.call(c[d].src,"?")<0?"?enablejsapi=1":"&enablejsapi=1";else break;b.push(c[d])}if(b.length>0)h.onYouTubePlayerAPIReady=function(){for(var a,c=0;c<b.length;c++)a=new h.YT.Player(b[c]),a.addEventListener("onStateChange",
G),a.addEventListener("onError",H)},a=f.createElement("script"),a.src="http://www.youtube.com/player_api",a.type="text/javascript",a.async=!0,c=f.getElementsByTagName("script")[0],c.parentNode.insertBefore(a,c)}o.prototype.g=function(a,b){if(a&&a.length)for(var c=0;c<a.length;c++)if(a[c]===b)return!0;return!1};o.prototype.isArray=function(a){return J.call(a)==="[object Array]"};o.prototype.a=function(a,b,c,d){function g(b){if(!b||!b.target)b=h.event,b.target=b.srcElement;return c.call(a,b)}a.addEventListener?
a.addEventListener(b,g,!!d):a.attachEvent?a.attachEvent("on"+b,g):(b="on"+b,typeof a[b]==="function"&&(g=function(a,b){return function(){a.apply(this,arguments);b.apply(this,arguments)}}(a[b],g)),a[b]=g)};o.prototype.h=function(a){function b(){if(!arguments.callee.n)arguments.callee.n=!0,a.apply(this,arguments)}/^(interactive|complete)/.test(f.readyState)?b():(this.a(f,"DOMContentLoaded",b,!1),this.a(h,"load",b,!1))};h._gaq=h._gaq||[];var u=h._gas||[];if(!(u.i>=0)){var f=h.document,J=Object.prototype.toString,
K=Object.prototype.hasOwnProperty,n=Array.prototype.slice,i=String.prototype.indexOf,x=f.location.href,l=f.documentElement;q.prototype.k=function(a,b){typeof a==="string"&&typeof b==="function"&&(typeof _gas.d[a]==="undefined"&&(_gas.d[a]=[]),_gas.d[a].push(b));return!1};q.prototype.l=function(){var a=n.call(arguments),b=a.shift(),a=!0,c,d,g,e,f;if(typeof b==="function")return p(function(a){return function(){a.call(_gas.f)}}(b));else if(typeof b==="object"&&b.length>0){d=b.shift();i.call(d,".")>=
0?(e=d.split(".")[0],d=d.split(".")[1]):e=m;if((g=_gas.d[d])&&g.length>0)for(c=0;c<g.length;c++)try{f=g[c].apply(_gas.f,b),f===!1&&(a=!1),f&&f.length>0&&(b=f)}catch(h){d!=="_trackException"&&_gas.push(["_trackException",h])}if(a===!1)return 1;if(d==="_setAccount"){for(c in _gas.b)if(_gas.b[c]==b[0]&&e===m)return 1;e=e||"_gas"+String(_gas.i+1);typeof _gas.b._gas1=="undefined"&&i.call(e,"_gas")!=-1&&(e="_gas1");_gas.b[e]=b[0];_gas.i+=1;e=e===_gas.e?"":e+".";return p([e+d,b[0]])}if(d==="_link"||d===
"_linkByPost")return a=n.call(b),a.unshift(d),p(a);if(e&&_gas.b[e])return f=(e===_gas.e?"":e+".")+d,a=n.call(b),a.unshift(f),p(a);g=0;for(c in _gas.b)K.call(_gas.b,c)&&(f=(c===_gas.e?"":c+".")+d,a=n.call(b),a.unshift(f),g+=p(a));return g?1:0}};q.prototype.push=function(){for(var a=n.call(arguments),b=0;b<a.length;b++)(function(a){h._gaq.push(function(){_gas.l.call(_gas.f,a)})})(a[b])};h._gas=_gas=new q;_gas.push(["_addHook","_trackException",function(a,b){_gas.push(["_trackEvent","Exception "+(a.name||
"Error"),b||a.message||a,x]);return!1}]);_gas.push(["_addHook","_setDebug",function(a){_gas.m=!!a}]);_gas.push(["_addHook","_popHook",function(a){(a=_gas.d[a])&&a.pop&&a.pop();return!1}]);_gas.push(["_addHook","_setDefaultTracker",function(a){_gas.e=a}]);_gas.push(["_addHook","_trackPageview",function(a,b){if(b&&typeof b==="string"){var c=f.title;h.p.push(function(){f.title=b},["_trackPageview",a],function(){f.title=c});return!1}return[a]}]);_gas.push(["_addHook","_trackDownloads",function(a){var b=
"xls,xlsx,doc,docx,ppt,pptx,pdf,txt,zip";b+=",rar,7z,exe,wma,mov,avi,wmv,mp3,csv,tsv";b=b.split(",");typeof a==="string"?b=b.concat(a.split(",")):this.isArray(a)&&(b=b.concat(a));D.call(this,b);return!1}]);_gas.push(["_addHook","_trackEvent",function(){var a=n.call(arguments);a[3]&&(a[3]=(a[3]<0?0:Math.round(a[3]))||0);return a}]);_gas.push(["_addHook","_trackForms",function(a){var b=this;this.h(function(){for(var c=f.getElementsByTagName("form"),d=0;d<c.length;d++){try{E.call(b,c[d],a)}catch(g){}if(a)break}return!1})}]);
var t=null,k=0;_gas.push(["_addHook","_trackMaxScroll",function(){this.a(h,"scroll",w);this.a(h,"beforeunload",F)}]);_gas.c=!1;_gas.push(["_addHook","_setAllowAnchor",function(a){_gas.c=!!a}]);_gas.push(["_addHook","_link",function(a,b){if(b===m)b=_gas.c;return[a,b]}]);_gas.push(["_addHook","_linkByPost",function(a,b){if(b===m)b=_gas.c;return[a,b]}]);var s=[],B=m;_gas.push(["_addHook","_setDomainName",function(a){if(i.call(f.location.hostname,a)<0)return s.push(a),!1;B=a}]);_gas.push(["_addHook",
"_addExternalDomainName",function(a){s.push(a);return!1}]);_gas.push(["_addHook","_setMultiDomain",function(a){var b=f.location.hostname,c=this,d,g,e,h=f.getElementsByTagName("a");a!=="now"&&a!=="mousedown"&&(a="click");for(d=0;d<h.length;d++)if(e=h[d],i.call(e.href,"http")===0&&!(e.hostname==b||i.call(e.hostname,B)>=0))for(g=0;g<s.length;g++)if(i.call(e.hostname,s[g])>=0)a==="now"?e.href=c.tracker._getLinkerUrl(e.href,_gas.c):a==="click"?this.a(e,a,function(a){_gas.push(["_link",this.href,_gas.c]);
a.preventDefault?a.preventDefault():a.returnValue=!1}):this.a(e,a,function(){this.href=c.tracker._getLinkerUrl(this.href,_gas.c)});return!1}]);_gas.push(["_addHook","_trackOutboundLinks",function(){this.a(h,"mousedown",function(a){a=a.target;if(a.nodeName=="A"&&(a.protocol=="http:"||a.protocol=="https:")&&i.call(a.href,f.location.hostname)===-1){var b=a.pathname+a.search+"",c=i.call(b,"__utm");c!==-1&&(b=b.substring(0,c));_gas.push(["_trackEvent","Outbound",a.hostname,b])}})}]);var A={},z=!1;_gas.push(["_addHook",
"_trackVimeo",function(a){var b=this;b.h(function(){y.call(b,a)});return!1}]);for(_gas.push(["_addHook","_trackYoutube",function(a){var b=this;b.h(function(){I.call(b,a)});return!1}]);_gas.j.length>0;)_gas.push(_gas.j.shift());_gaq&&_gaq.length>=0&&function(){var a=f.createElement("script");a.type="text/javascript";a.async=!0;a.src=("https:"==f.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var b=f.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}()}})(window);
