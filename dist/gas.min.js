/*
 Copyright 2011, Cardinal Path and Direct Performance.

 GAS - Google Analytics on Steroids
 https://bitbucket.org/dpc/gas

 @author Eduardo Cereto <eduardocereto@gmail.com>
 $Revision$
 $Date$
 Licensed under the MIT license.
*/
(function(c,k){function r(a){return a===c._gas._default_tracker?"":a+"."}function m(a){if(_gas.debug_mode)try{console.log(a)}catch(b){}return c._gaq.push(a)}function D(a,b){if(typeof a!=="string")return!1;var c=a.split("?")[0],c=c.split(".");return(c=c[c.length-1])&&this.inArray(b,c)?c:!1}function E(a){var b=this;this._addEventListener(c,"mousedown",function(c){if(c.target&&c.target.tagName==="A"){var d=D.call(b,c.target.href,a);d&&_gas.push(["_trackEvent","Download",d,c.target.href])}})}function F(a,
b){function g(b){var c=b.target||this,c=c.name||c.id||c.type,b=b.type,d=a.name||a.id;_gas.push(["_trackEvent","Form Tracking","form"+(d?" ("+d+")":""),c+" ("+b+")"])}var d=this;b===k&&(b=!1);if(b)d._addEventListener(c,"click",function(a){try{var b=a.target;a.type=="click"&&d.inArray(["button","submit","image","reset"],b.type.toLowerCase())&&g(a)}catch(c){}}),d._addEventListener(e.body,"change",function(a){try{var b=a.target;a.type=="change"&&d.inArray(["input","select","textarea","hidden"],b.nodeName.toLowerCase())&&
g(a)}catch(c){}});else{var h,f;if(!a.elements||!a.elements.length)return!1;for(h=0;h<a.elements.length;h++)f=a.elements[h],d.inArray(["button","submit","image","reset"],f.type)?d._addEventListener(f,"click",g):d._addEventListener(f,"change",g);d._addEventListener(a,"submit",g)}}function t(){var a=0,b=0;if(typeof c.innerWidth=="number")a=c.innerWidth,b=c.innerHeight;else if(e.documentElement&&(e.documentElement.clientWidth||e.documentElement.clientHeight))a=e.documentElement.clientWidth,b=e.documentElement.clientHeight;
else if(e.body&&(e.body.clientWidth||e.body.clientHeight))a=e.body.clientWidth,b=e.body.clientHeight;return[a,b]}function u(){var a=0,b=0;if(typeof c.pageYOffset=="number")b=c.pageYOffset,a=c.pageXOffset;else if(e.body&&(e.body.scrollLeft||e.body.scrollTop))b=e.body.scrollTop,a=e.body.scrollLeft;else if(e.documentElement&&(e.documentElement.scrollLeft||e.documentElement.scrollTop))b=e.documentElement.scrollTop,a=e.documentElement.scrollLeft;return[a,b]}function v(){var a=e;return Math.max(Math.max(a.body.scrollHeight,
a.documentElement.scrollHeight),Math.max(a.body.offsetHeight,a.documentElement.offsetHeight),Math.max(a.body.clientHeight,a.documentElement.clientHeight))}function w(a){s&&clearTimeout(s);a===!0?l=Math.max((u()[1]+t()[1])/v()*100,l):s=setTimeout(function(){l=Math.max((u()[1]+t()[1])/v()*100,l)},400)}function G(){this._addEventListener(c,"beforeunload",function(){w(!0);var a=Math.floor(l/10)*10;a<100&&(a=String(a)+"-"+String(a+9));_gas.push(["_trackEvent","Max Scroll",x,String(a),Math.round(l),!0])})}
function H(){for(var a=e.links,b=0;b<a.length;b++)j.call(a[b].href,"http")==0&&j.call(a[b].href,e.location.host)<0&&this._addEventListener(a[b],"mousedown",function(a){return function(){var b=a.href.substring(j.call(a.href,"//")+2),c=j.call(b,"/")>-1?j.call(b,"/"):k,f=j.call(b,"__utma")>-1?j.call(b,"__utma"):k;_gaq.push(["_trackEvent","Outbound",b.substring(0,c),b.substring(c,f)||"",0,!0])}}(a[b]))}function p(a,b,c){if(!c.contentWindow||!c.contentWindow.postMessage)return!1;var d=c.getAttribute("src").split("?")[0],
a=JSON.stringify({method:a,value:b});c.contentWindow.postMessage(a,d);return!0}function y(a){for(var b=e.getElementsByTagName("iframe"),g=0,d,h,f,i=0;i<b.length;i++)if(j.call(b[i].src,"//player.vimeo.com")>-1){d="gas_vimeo_"+i;h=b[i].src;f="?";j.call(h,"?")>-1&&(f="&");if(j.call(h,"api=1")<0)if(a)h+=f+"api=1&player_id="+d;else break;else j.call(h,"player_id=")<-1&&(h+=f+"player_id="+d);g++;b[i].id=d;if(b[i].src!==h){b[i].src=h;break}p("getVideoUrl","",b[i]);p("addEventListener","play",b[i]);p("addEventListener",
"pause",b[i]);p("addEventListener","finish",b[i])}g>0&&z===!1&&(this._addEventListener(c,"message",function(a){if(j.call(a.origin,"//player.vimeo.com")>-1)if(a=JSON.parse(a.data),a.event==="ready")y();else if(a.method){if(a.method=="getVideoUrl")A[a.player_id]=a.value}else _gas.push(["_trackEvent","Vimeo Video",a.event,A[a.player_id]])},!1),z=!0)}function I(a){var b="";switch(a.data){case YT.PlayerState.ENDED:b="finish";break;case YT.PlayerState.PLAYING:b="play";break;case YT.PlayerState.PAUSED:b=
"pause"}b&&_gas.push(["_trackEvent","YouTube Video",b,a.target.getVideoUrl()])}function J(a){_gas.push(["_trackEvent","YouTube Video","error",a.data])}function K(a){for(var b=[],g=e.getElementsByTagName("iframe"),d=0;d<g.length;d++)if(j.call(g[d].src,"//www.youtube.com/embed")>-1){if(j.call(g[d].src,"enablejsapi=1")<0)if(a)g[d].src+=j.call(g[d].src,"?")<0?"?enablejsapi=1":"&enablejsapi=1";else break;b.push(g[d])}if(b.length>0)c.onYouTubePlayerAPIReady=function(){for(var a,c=0;c<b.length;c++)a=new YT.Player(b[c]),
a.addEventListener("onStateChange",I),a.addEventListener("onError",J)},a=e.createElement("script"),a.src="http://www.youtube.com/player_api",a.type="text/javascript",a.async=!0,g=e.getElementsByTagName("script")[0],g.parentNode.insertBefore(a,g)}c._gaq=c._gaq||[];var B=c._gas||[];if(!(B._accounts_length>=0)){var e=c.document,L=Object.prototype.toString,M=Object.prototype.hasOwnProperty,n=Array.prototype.slice,j=String.prototype.indexOf,x=e.location.href;c._gas=_gas={_accounts:{},_accounts_length:0,
_hooks:{},_queue:B,_default_tracker:"_gas1",gh:{}};c._gas._hooks._addHook=[function(a,b){typeof a==="string"&&typeof b==="function"&&(typeof c._gas._hooks[a]==="undefined"&&(c._gas._hooks[a]=[]),c._gas._hooks[a].push(b));return!1}];c._gas._execute=function(){var a=n.call(arguments),b=a.shift(),a=!0,g,d,e,f,i;if(typeof b==="function")return m(function(a){return function(){a.call(c._gas.gh)}}(b));else if(typeof b==="object"&&b.length>0){d=b.shift();j.call(d,".")>=0?(f=d.split(".")[0],d=d.split(".")[1]):
f=k;if((e=c._gas._hooks[d])&&e.length>0)for(g=0;g<e.length;g++)try{i=e[g].apply(c._gas.gh,b),i===!1&&(a=!1),i&&i.length>0&&(b=i)}catch(l){d!=="_trackException"&&c._gas.push(["_trackException",l])}if(a===!1)return 1;if(d==="_setAccount"){for(g in c._gas._accounts)if(c._gas._accounts[g]==b[0]&&f===k)return 1;f=f||"_gas"+String(c._gas._accounts_length+1);typeof c._gas._accounts._gas1=="undefined"&&j.call(f,"_gas")!=-1&&(f="_gas1");c._gas._accounts[f]=b[0];c._gas._accounts_length+=1;f=r(f);return m([f+
d,b[0]])}if(d==="_link"||d==="_linkByPost")return a=n.call(b),a.unshift(d),m(a);if(f&&c._gas._accounts[f])return i=r(f)+d,a=n.call(b),a.unshift(i),m(a);e=0;for(g in c._gas._accounts)M.call(c._gas._accounts,g)&&(i=r(g)+d,a=n.call(b),a.unshift(i),e+=m(a));return e?1:0}};c._gas.push=function(){for(var a=n.call(arguments),b=0;b<a.length;b++)(function(a){_gaq.push(function(){c._gas._execute.call(c._gas.gh,a)})})(a[b])};c._gas.push(["_addHook","_trackException",function(a,b){c._gas.push(["_trackEvent",
"Exception "+(a.name||"Error"),b||a.message||a,x]);return!1}]);c._gas.push(["_addHook","_setDebug",function(a){c._gas.debug_mode=!!a}]);c._gas.push(["_addHook","_popHook",function(a){(a=c._gas._hooks[a])&&a.pop&&a.pop();return!1}]);c._gas.push(["_addHook","_setDefaultTracker",function(a){c._gas._default_tracker=a}]);var o=function(a){this.tracker=a};o.prototype.inArray=function(a,b){if(a&&a.length)for(var c=0;c<a.length;c++)if(a[c]===b)return!0;return!1};o.prototype.isArray=function(a){return L.call(a)===
"[object Array]"};o.prototype._sanitizeString=function(a,b){a=a.toLowerCase().replace(/^\ +/,"").replace(/\ +$/,"").replace(/\s+/g,"_").replace(/[\u00e1\u00e0\u00e2\u00e3\u00e5\u00e4\u00e6\u00aa]/g,"a").replace(/[\u00e9\u00e8\u00ea\u00eb\u0404\u20ac]/g,"e").replace(/[\u00ed\u00ec\u00ee\u00ef]/g,"i").replace(/[\u00f3\u00f2\u00f4\u00f5\u00f6\u00f8\u00ba]/g,"o").replace(/[\u00fa\u00f9\u00fb\u00fc]/g,"u").replace(/[\u00e7\u00a2\u00a9]/g,"c");b&&(a=a.replace(/[^a-z0-9_-]/g,"_"));return a.replace(/_+/g,
"_")};o.prototype._addEventListener=function(a,b,e,d){var h=function(b){b=b||c.event;return e.call(a,b)};d===k&&(d=!1);return a.addEventListener?(a.addEventListener(b,h,!!d),!0):a.attachEvent?a.attachEvent("on"+b,h):(b="on"+b,typeof a[b]==="function"&&(h=function(a,b){return function(){a.apply(this,arguments);b.apply(this,arguments)}}(a[b],h)),a[b]=h,!0)};c._gas.push(function(){var a=_gat._getTrackerByName();c._gas.gh=new o(a)});c._gas.push(["_addHook","_trackPageview",function(a,b){if(b&&typeof b===
"string"){var g=e.title;c._gas.push(function(){e.title=b},["_trackPageview",a],function(){e.title=g});return!1}return[a]}]);c._gas.push(["_addHook","_trackDownload",function(a){var b="xls,xlsx,doc,docx,ppt,pptx,pdf,txt,zip";b+=",rar,7z,exe,wma,mov,avi,wmv,mp3";b=b.split(",");typeof a==="string"?b=b.concat(a.split(",")):this.isArray(a)&&(b=b.concat(a));E.call(this,b);return!1}]);c._gas.push(["_addHook","_trackEvent",function(a,b,c,d){d&&(d=(d<0?0:Math.round(d))||0);return[a,b,c,d]}]);c._gas.push(["_addHook",
"_trackForms",function(a){for(var b=0;b<e.forms.length;b++){try{F.call(this,e.forms[b],a)}catch(c){}if(a)break}return!1}]);var s=null,l=0;c._gas.push(["_addHook","_trackMaxSrcoll",function(){this._addEventListener(c,"scroll",w);G.call(this)}]);c._gas._allowAnchor=!1;c._gas.push(["_addHook","_setAllowAnchor",function(a){_gas._allowAnchor=a}]);c._gas.push(["_addHook","_link",function(a,b){if(b===k)b=_gas._allowAnchor;return[a,b]}]);c._gas.push(["_addHook","_linkByPost",function(a,b){if(b===k)b=_gas._allowAnchor;
return[a,b]}]);var q=[],C=k;_gas.push(["_addHook","_setDomainName",function(a){if(j.call(e.location.hostname,a)<0)return q.push(a),!1;C=a}]);_gas.push(["_addHook","_addExternalDomainName",function(a){q.push(a);return!1}]);_gas.push(["_addHook","_setMultiDomain",function(a){var b=e.location.hostname,c=this,d,h,f;a!=="now"&&a!=="mousedown"&&(a="click");for(d=0;d<e.links.length;d++)if(f=e.links[d],j.call(f.href,"http")==0&&!(f.hostname==b||j.call(f.hostname,C)>=0))for(h=0;h<q.length;h++)if(j.call(f.hostname,
q[h])>=0)a==="now"?f.href=c.tracker._getLinkerUrl(f.href,_gas._allowAnchor):a==="click"?this._addEventListener(f,a,function(a){_gas.push(["_link",this.href,_gas._allowAnchor]);a.preventDefault?a.preventDefault():a.returnValue=!1}):this._addEventListener(f,a,function(){this.href=c.tracker._getLinkerUrl(this.href,_gas._allowAnchor)});return!1}]);c._gas.push(["_addHook","_trackOutboundLinks",function(){H.call(this)}]);var A={},z=!1;c._gas.push(["_addHook","_trackVimeo",function(a){y.call(this,a);return!1}]);
for(c._gas.push(["_addHook","_trackYoutube",function(a){K.call(this,a);return!1}]);c._gas._queue.length>0;)c._gas.push(c._gas._queue.shift());_gaq&&_gaq.length>=0&&function(){var a=e.createElement("script");a.type="text/javascript";a.async=!0;a.src=("https:"==e.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var b=e.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}()}})(window);
